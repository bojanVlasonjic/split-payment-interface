<form class="new-account-form" #accountForm="ngForm">
    <div class="form-group">
        <mat-form-field class="full-width">
            <input type="text"
                   placeholder="Enter account number"
                   name="accNum"
                   id="accNum"
                   pattern="[0-9]{3}\-[0-9]+\-[0-9]{2}"
                   required
                   matInput
                   [formControl]="accountNumControl"
                   [matAutocomplete]="auto">
            <mat-autocomplete (optionSelected)="accountSelected($event)" #auto="matAutocomplete">
              <mat-option *ngFor="let acc of filteredAccounts | async" [value]="acc.number">
                {{ acc.number }} {{ acc.name }}
              </mat-option>
            </mat-autocomplete>
        </mat-form-field>
        <small *ngIf="accountNumControl.errors?.required && accountNumControl.touched" class="error-message">
            Account number is required
        </small>
        <small *ngIf="accountNumControl.errors?.pattern && accountNumControl.touched" class="error-message">
            Invalid pattern, example pattern: 123-12345-12
        </small> 
    </div>
    <div class="form-group">
        <mat-form-field class="full-width">
            <mat-label>Account name</mat-label>
            <input matInput [(ngModel)]="paymentSplit.account.name" name="accName" id="accName"
                required #accName="ngModel" autocomplete="off">
        </mat-form-field>
        <small [hidden]="accName.valid || accName.pristine" class="error-message">
            Account name is required
        </small> 
    </div>
    <div class="form-group">
        <mat-form-field class="full-width">
            <mat-label>Account owner</mat-label>
            <input matInput [(ngModel)]="paymentSplit.account.recipientName" name="accOwner" id="accOwner"
                required #accOwner="ngModel" autocomplete="off">
        </mat-form-field>
        <small [hidden]="accOwner.valid || accOwner.pristine" class="error-message">
            Account owner's name is required
        </small>
    </div>

    <div class="form-group">
        <mat-form-field class="full-width">
            <mat-label>Owner's address</mat-label>
            <input matInput [(ngModel)]="paymentSplit.account.recipientAddress" name="ownerAddress" 
                id="ownerAddress" required #ownerAddress="ngModel" autocomplete="off">
        </mat-form-field>
        <small [hidden]="ownerAddress.valid || ownerAddress.pristine" class="error-message">
            Account owner's address is required
        </small>
    </div>

    <label>How would you like to specify the amount of funds to transfer?</label>
    <br/>

    <mat-radio-group [(ngModel)]="splitType" name="splitType">
    <mat-radio-button value="fixed" class="splitTypeRadio">
      Fixed (rsd)
    </mat-radio-button>
    <mat-radio-button value="percentual" class="split-type-radio">
        Percentual (%)
    </mat-radio-button>
  </mat-radio-group>

    <div class="form-row" [ngClass]="{'disabled-slider': splitType != 'fixed'}">
        <div class="form-group col-9">
            <mat-slider min="1" [max]="article.price" step="1" value="1"
                thumbLabel (input)="onFixedValueChange($event)" name="fixedInvestmentSlider"
                [(ngModel)]="paymentSplit.amount">
            </mat-slider>
        </div>
        <div class="form-group col-3">
            <input type="number" class="form-control" name="accInvestmentInput" 
                [(ngModel)]="paymentSplit.amount">
        </div>
    </div>
    
    <div class="form-row" [ngClass]="{'disabled-slider': splitType != 'percentual'}">
        <div class="form-group col-9">
            <mat-slider min="1" max="100" step="1" value="1" thumbLabel 
                (input)="onPercentualValueChange($event)" name="percentualInvestmentSlider"
                [(ngModel)]="investmentPercentage">
            </mat-slider>
        </div>
        <div class="form-group col-3">
            <input type="number" class="form-control" name="investPercentageInput"
                [(ngModel)]="investmentPercentage" (input)="onPercentualInputChange($event)">
        </div>
    </div>
    <div class="form-row">
        <div class="col-12">
            <small class="big-error-message" *ngIf="paymentSplit.amount <= 0 && accountForm.submitted">
                Amount to transfer must be specified
            </small>
        </div>
    </div>  

    <label class="highlighted-text">Amount to transfer: &nbsp; {{ paymentSplit.amount }} rsd </label>

    <br/>
    <button type="submit" class="btn btn-dark" *ngIf="!isUpdating" (click)="createPaymentSplit()"
        [disabled]="!accountForm.form.valid || accountNumControl.errors">
        Add account
    </button>
    <button type="submit" class="btn btn-dark" *ngIf="isUpdating" (click)="updatePaymentSplit()"
        [disabled]="!accountForm.form.valid || accountNumControl.errors">
        Update account
    </button>
</form>


